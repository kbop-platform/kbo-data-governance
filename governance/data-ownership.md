# 데이터 오너십

> 최종수정: 2026-02-24 | KBO 데이터 표준 정의서 (RFP DAR-001)
> 📋 문서 성격: 데이터 오너십 정책(안) · 현행 S2i 프로세스 참고 포함

## 1. 개요 및 적용 범위

본 문서는 KBO 데이터 시스템의 데이터 흐름 경로상 각 계층의 **책임자**와 **권한**을 정의한다.
모든 데이터 자산은 명확한 오너(Owner)가 있어야 하며, 오너는 해당 데이터의 품질·변경·접근에 대한 최종 책임을 진다.

**적용 범위**:
- Sports2i(S2i) 운영 시스템으로부터 수신하는 DB2(시즌 13개), DB1(영구 4개)
- KBO 자체 구축 테이블 (세이버메트릭스, pitch-by-pitch 등)
- 데이터 사전, 표준 문서, 코드 사전 등 거버넌스 문서 자산

→ 참고: [ID 체계](../standards/id-system.md) - 식별자별 오너십 원칙
→ 참고: [코드 사전](../standards-dict/codes.md) - 코드값 변경 권한

---

## 2. 데이터 흐름 및 계층 구조

### 2.1 전체 데이터 흐름도

```
┌─────────────┐     경기 당일 전송      ┌───────────────┐
│  S2i 운영DB  │ ──────────────────────→ │  DB2 (시즌 13) │
│  (외부)      │                         │  시즌별 데이터   │
└─────────────┘                         └───────┬───────┘
                                                │ 확정 후 반영
                                                ▼
                                        ┌───────────────┐
                                        │  DB1 (영구 4)   │
                                        │  누적/마스터     │
                                        └───────────────┘

┌─────────────┐     KBO 자체 구축       ┌───────────────┐
│  KBO 분석팀  │ ──────────────────────→ │  KBO 자체 DB    │
│  (내부)      │                         │  세이버/P-b-P   │
└─────────────┘                         └───────────────┘
```

### 2.2 계층별 특성

| 계층 | DB 예시 | 데이터 성격 | 갱신 주기 | 주 오너 |
|------|---------|------------|----------|---------|
| **DB2 (시즌)** | DB2_BASEBALL, DB2_ALLSTAR 등 13개 | 시즌 경기 기록 | 경기 당일 S2i 전송 | S2i 담당 (R-01) |
| **DB1 (영구)** | DB1_RECORD 등 4개 | 확정된 영구 기록 | DB2 확정 후 반영 | DBA (R-04) |
| **KBO 자체** | (신규) | 세이버메트릭스, pitch-by-pitch | 자체 배치/수동 | 데이터팀 (R-06) |
| **거버넌스 문서** | standards/, governance/ 등 | 표준 정의, 정책 | 요청 시 개정 | 거버넌스 위원회 (R-05) |

---

## 3. 역할 정의

### 3.1 역할 목록

| 역할 ID | 역할명 | 소속 | 주요 책임 |
|---------|--------|------|----------|
| **R-01** | S2i 데이터 담당 | Sports2i (외주) | DB2 데이터 전송, 스키마 변경 사전 통보, 미확인 코드 회신 |
| **R-02** | 기록원 (Scorer) | KBO 기록위원회 | 경기 중 실시간 데이터 입력 (DRAFT 상태), 오류 보고 |
| **R-03** | 기록위원회 | KBO 기록위원회 | 기록 검증(REVIEW) 및 확정(CONFIRMED), 정정(REVISED) 승인 |
| **R-04** | DBA | KBO IT팀 | DB 스키마 관리, DB1 반영, 백업·복구, 접근 권한 관리 |
| **R-05** | 거버넌스 위원회 | KBO (IT팀+기록위+운영팀) | 표준 문서 개정 승인, 신규 코드 확정, 구조 변경 최종 승인 |
| **R-06** | 데이터팀 | KBO IT팀 | KBO 자체 테이블 설계·운영, 세이버메트릭스 산출, 품질 모니터링 |

### 3.2 역할별 DB 접근 권한 매트릭스

| DB 계층 | R-01 (S2i) | R-02 (기록원) | R-03 (기록위) | R-04 (DBA) | R-05 (거버넌스) | R-06 (데이터팀) |
|---------|-----------|-------------|-------------|-----------|--------------|--------------|
| DB2 (시즌) | **W** (전송) | R | R | **RWA** | R | R |
| DB1 (영구) | - | - | R | **RWA** | R | R |
| KBO 자체 | - | - | R | **RWA** | R | **RW** |
| 거버넌스 문서 | R | R | R/E | R | **E/A** | R/E |

> **범례**: R=읽기, W=쓰기, A=관리(Admin), E=편집(문서)

---

## 4. 테이블 오너십 매트릭스

### 4.1 도메인별 오너십

| 도메인 | 테이블 (주요) | 데이터 생성자 | 품질 책임 | 스키마 변경 권한 |
|--------|-------------|-------------|----------|----------------|
| **경기 기록 (game/)** | GAMEINFO, HITTER, PITCHER, SCORE, GAMECONTAPP, ENTRY, DEFEN, GAME_HR 등 12종 | R-01 (S2i 전송) | R-03 (기록위원회) | R-05 (거버넌스 위원회) |
| **통계 (stats/)** | BAT_TOTAL, PIT_TOTAL, TEAM_RANK, KBO_BATRESULT, SEASON_PLAYER_* 등 10종 | R-01 (S2i 집계) | R-03 (기록위원회) | R-05 (거버넌스 위원회) |
| **실시간 (realtime/)** | IE_LIVE_TEXT, IE_BALL_COUNT, IE_BATTER_RECORD, IE_GAMESTATE 등 9종 | R-01 (S2i 실시간) | R-01 (S2i) | R-05 (거버넌스 위원회) |
| **마스터 (master/)** | PERSON, TEAM, STADIUM, KBO_SCHEDULE 등 8종 | R-01 (S2i) / R-04 (DBA) | R-04 (DBA) | R-05 (거버넌스 위원회) |
| **KBO 자체** (신규) | PITCH_BY_PITCH, SABER_HITTER_SEASON, SABER_PITCHER_SEASON 등 | R-06 (데이터팀) | R-06 (데이터팀) | R-05 (거버넌스 위원회) |

### 4.2 미확인 컬럼 오너십 (+1 컬럼 49개 테이블)

49개 테이블에서 S2i가 백업DB 대비 1개 컬럼을 추가 보유하고 있으며, 해당 컬럼명은 미확인 상태이다.

| 항목 | 내용 |
|------|------|
| 영향 테이블 | Hitter(11), Pitcher(8), BatTotal(6), PitTotal(6), TeamRank(7), GAMECONTAPP(1), IE_GAMESTATE(8), KBO_ETCGAME(3), KBO_PITRESULT(3) |
| 추정 컬럼 | `INPUTTIME`, `REG_DT`, `UPDATE_DT` 등 감사/관리 컬럼 |
| 오너십 | R-01 (S2i) - S2i 운영DB 스키마에 따른 추가 |
| 조치 | S2i에 컬럼명 확인 요청 → 수령 시 `dictionary/` 해당 파일에 반영 |

→ 참고: [컬럼 차이 분석 §2](../migration/column-diff.md#2-1-49)

---

## 5. 데이터 티어 분류 기준

> **⚠ 초안(Draft)**: 아래 기준은 테이블 메타데이터·활용도 분석을 토대로 작성한 **초안**이며, KBO 내부 검토를 거쳐 확정해야 한다. 현재 `.enriched-cache.json`에 배정된 39개 테이블의 티어 값도 초안이다.

### 5.1 분류 체계

| 티어 | 라벨 | 정의 | 장애 시 영향 |
|------|------|------|-------------|
| **Tier 1** | Critical | 경기 진행·중계·공식 기록에 필수. 해당 테이블이 없으면 핵심 서비스 운영 불가 | 실시간 중계·공식 기록 발행 중단 |
| **Tier 2** | Standard | 통계 산출·분석·일정 관리에 활용. 운영은 가능하나 분석·보고 업무에 지장 | 통계 서비스·리포트 지연 |
| **Tier 3** | Reference | 참조·보조 데이터. 손실되어도 다른 소스에서 복구 가능하거나 운영 영향 미미 | 부가 정보 조회 불가 (운영 무관) |

### 5.2 분류 판단 기준

아래 요소를 종합적으로 고려하여 티어를 배정한다:

| 판단 요소 | Tier 1 경향 | Tier 3 경향 |
|-----------|------------|------------|
| **소비자 수** | 3개 이상 팀/시스템 (방송·앱·외부 API) | 1개 팀 내부 참조 |
| **실시간 의존** | 실시간 중계·전광판 등 지연 불가 | 배치·수동 참조 |
| **대체 불가성** | 이 테이블이 유일한 소스 | 다른 테이블에서 파생 가능 |
| **외부 공개** | 외부 API·미디어 제공 | 내부 전용 |
| **복구 난이도** | 재생성 불가 (원본 기록) | 재조회·재계산 가능 |

### 5.3 현행 배정 현황 (초안)

| 티어 | 테이블 수 | 대표 테이블 |
|------|----------|------------|
| Tier 1 | 12 | GAMEINFO, Hitter, Pitcher, Score, IE_LiveText, person 등 |
| Tier 2 | 16 | BatTotal, PitTotal, KBO_schedule, SEASON_PLAYER_* 등 |
| Tier 3 | 11 | STADIUM, TEAM, person2, IE_log, PERSON_FA 등 |

### 5.4 검토 절차

1. 데이터팀(R-06)이 초안 배정 → 오너(R-03/R-04/R-05)에게 검토 요청
2. 각 오너가 소관 테이블의 장애 영향도를 기준으로 확인·수정
3. 거버넌스 위원회(R-05)가 최종 승인 → `.enriched-cache.json` 반영
4. 연 1회 또는 신규 테이블 추가 시 재검토

---

## 6. S2i 계약 데이터 관리 원칙

### 6.1 데이터 수신 SLA

| 항목 | 기준 | 비고 |
|------|------|------|
| 전송 시점 | 경기 종료 후 (본 정의서 범위 외 - S2i 계약서 기반 별도 확정) | S2i가 DB2에 데이터 전송 |
| 전송 대상 | 해당 시즌 DB2 전체 (13개 DB) | 경기 당일 발생분 |
| 전송 방식 | S2i 운영DB → KBO 백업DB 동기화 | `_220328` = 최초 백업일 |
| 재전송 요청 | 수신 누락·오류 시 R-04(DBA)가 R-01(S2i)에 요청 | 최대 1영업일 내 회신 |

### 6.2 불일치 항목 협의 절차

S2i 전송 데이터와 KBO 백업DB 간 불일치 발생 시:

1. **감지**: R-04(DBA) 또는 R-06(데이터팀)이 품질 모니터링 중 감지
2. **보고**: R-04 → R-05(거버넌스 위원회)에 불일치 내역 보고
3. **확인 요청**: R-05 → R-01(S2i)에 공식 확인 요청 (문서화)
4. **회신**: R-01(S2i)이 확인 결과 회신 - 수정 전송 또는 현행 정당성 설명
5. **반영**: R-04(DBA)가 합의된 내용에 따라 DB 반영

**현재 미결 불일치 항목**:
- +1 컬럼 49개 테이블 (§4.2)
- DEFEN +6 컬럼, ENTRY -1 컬럼 상세
- 미확인 코드: BH(14,749건), place_cd 문자코드(A~S), game_flag(4,7,8,9), series_id(1~9)

→ 참고: [코드 사전 부록C](../standards-dict/codes.md)

---

## 7. ID 불변 원칙과 오너십

모든 ID는 부여 후 **변경 불가**(immutable)이며, ID 오너십은 다음과 같다:

| ID | 타입 | 부여 주체 | 변경 권한 | 불변 원칙 |
|----|------|----------|----------|----------|
| `game_id` | char(13) | R-01 (S2i) | 없음 (불변) | 팀코드 변경에도 과거 game_id 유지 |
| `player_id` | int | R-01 (S2i) | 없음 (불변) | 은퇴·복귀에도 동일 ID 유지 |
| `team_id` | char(2) | R-05 (거버넌스 위원회) | 없음 (불변) | 구단명 변경에도 코드 유지 (OB=두산, SK=SSG) |
| `stadium_id` | char(2) | R-05 (거버넌스 위원회) | 없음 (불변) | 구장명 변경에도 코드 유지 |
| `season_id` | smallint | 자동 (연도) | 없음 (불변) | 4자리 연도, 9999=통산 |
| `league_id`, `series_id` | smallint | R-01 (S2i) | 없음 (불변) | |

> game_id 내부의 팀코드는 **역사적 코드 고정**. SK(현 SSG), OB(현 두산) 등 팀명이 바뀌어도 game_id는 변경하지 않는다.

→ 참고: [ID 체계 §5](../standards/id-system.md#5) - 특수값 처리
→ 참고: [ID 체계 §6](../standards/id-system.md#6) - 팀 코드 이력

---

## 8. 합계행(T/B) 오너십

Hitter, Pitcher 테이블에서 `PCODE = 'T'`(원정팀 합계), `PCODE = 'B'`(홈팀 합계) 행의 관리:

| 항목 | 내용 |
|------|------|
| 현행 생성 주체 | R-01 (S2i) - 경기 기록 전송 시 합계행 포함 |
| 품질 책임 | R-03 (기록위원회) - 개인 기록 합산과 합계행 정합성 검증 |
| 전환 계획 | 방안 A(합계행 분리) 권고 - 마이그레이션 시 R-04(DBA) 주도 |
| 전환 시점 | 본 정의서 범위 외 - DAR-009 마이그레이션 과업에서 DBA 주도로 확정 |

**전환 전 운영 원칙**:
1. 합계행은 현행 그대로 수신·저장
2. 집계 쿼리 시 `WHERE PCODE NOT IN ('T', 'B')` 필터 필수
3. 품질 검증: 합계행 값 = 개인 기록 SUM (§ quality-rules.md §6.2)

→ 참고: [ID 체계 §5.1](../standards/id-system.md#5) - 합계행 표준 처리 방안

---

## 9. 감사(Audit) 및 로그

### 9.1 감사 컬럼 표준

KBO 자체 신규 테이블에는 다음 감사 컬럼을 필수로 포함한다:

| 컬럼 | 타입 | NOT NULL | 설명 |
|------|------|----------|------|
| `reg_dt` | `datetime2` | 필수 | 행 최초 등록 일시 (DEFAULT GETDATE()) |
| `upd_dt` | `datetime2` | 필수 | 행 최종 수정 일시 (트리거 또는 앱 갱신) |
| `reg_user_id` | `varchar(50)` | 필수 | 등록자 ID (시스템 계정 또는 사용자 ID) |

> **소급 적용**: 기존 S2i 전송 테이블에는 감사 컬럼이 없다. 신규 테이블만 적용하며, 기존 테이블 소급은 본 정의서 범위 외 - DAR-009 마이그레이션 시 판단.

### 9.2 데이터 변경 로그

기록 상태 전이(`record_status_cd` 변경) 시 다음을 로그에 기록한다:

| 항목 | 내용 |
|------|------|
| 대상 | HITTER, PITCHER, SCORE, GAME_CONT_APP 등 기록 테이블 |
| 로그 내용 | game_id, 변경 전 상태, 변경 후 상태, 변경자(역할 ID), 변경 일시, 사유 |
| 저장 위치 | 별도 감사 로그 테이블 (KBO 자체 구축) |
| 보존 기간 | 영구 (기록 데이터의 변경 이력은 삭제하지 않음) |

→ 참고: [코드 사전 §9](../standards-dict/codes.md) - record_status_cd 정의
→ 참고: [변경 절차](./change-process.md) - 기록 상태 전이 절차
