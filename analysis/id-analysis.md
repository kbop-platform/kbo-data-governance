# 식별자(ID) 체계 분석

> 분석 일시: 2026-02-23
> 분석 대상: 19개 DB, 실제 데이터 샘플 기반

## 1. 핵심 식별자 요약

| 식별자 | 형식 | 길이 | 설명 | 사용 범위 |
|--------|------|------|------|----------|
| **GMKEY** | `YYYYMMDDVVHH#` | 13자 | 경기 고유키 | 구세대 전체 |
| **G_ID** | `YYYYMMDDVVHH#` | 13자 | 경기 ID (GMKEY와 동일 형식) | 신세대 테이블 |
| **PCODE** | `NNNNN` | 5자리 | 선수 코드 | 구세대 전체 |
| **P_ID** | `NNNNN` | 5자리 | 선수 ID (PCODE와 동일) | 신세대 테이블 |
| **T_ID** | `XX` | 2자 | 팀 코드 | 전체 |
| **SEASON_ID** | `YYYY` | 4자리 | 시즌(연도) | 신세대 테이블 |
| **LE_ID** | `N` | 1~2자리 | 리그 ID | 신세대 테이블 |
| **SR_ID** | `N` | 1~2자리 | 시리즈 ID | 신세대 테이블 |
| **stadium_key** | `XX` | 2자 | 구장 코드 | KBO_schedule, STADIUM |

---

## 2. GMKEY (경기 고유키) 상세

### 2.1 형식
```
YYYYMMDDVVHH#
│       ││  └─ 더블헤더 번호 (0=단일경기, 1=1차전, 2=2차전)
│       │└──── 홈팀 코드 (2자)
│       └───── 원정팀 코드 (2자)
└────────────── 경기 일자 (8자리)
```

### 2.2 실제 데이터 예시
| GMKEY | 일자 | 원정팀 | 홈팀 | 더블헤더 |
|-------|------|--------|------|---------|
| `20250322HHKT0` | 2025-03-22 | HH(키움) | KT(KT) | 0(단일) |
| `20250322LTLG0` | 2025-03-22 | LT(롯데) | LG(LG) | 0(단일) |
| `20250322NCHT0` | 2025-03-22 | NC(NC) | HT(KIA) | 0(단일) |
| `20250322OBSK0` | 2025-03-22 | OB(두산) | SK(SSG) | 0(단일) |
| `20250322WOSS0` | 2025-03-22 | WO(한화) | SS(삼성) | 0(단일) |

### 2.3 데이터 범위
- **DB1 (누적)**: `19820327SSLG0` ~ `20251004SSHT0` (23,579경기, **1982년부터**)
- **DB2 (단일시즌)**: `20250322HHKT0` ~ `20251004SSHT0` (720경기, 2025시즌)
- 경기 길이: **고정 13자**

### 2.4 올스타/국제대회 등 특수 GMKEY
- 올스타/시범경기 등도 동일 형식 (`YYYYMMDDVVHH#`)
- KBO_schedule에 `99990725EAWE0` 같은 **9999** 시작 키도 존재 → 과거 올스타전 등 특별경기

### 2.5 GMKEY와 G_ID 관계
- `G_ID` = `GMKEY`와 **동일 형식** (13자 `YYYYMMDDVVHH#`)
- 신세대 테이블(`GAME_HR`, `CANCEL_GAME`, `FALL_LEAGUE`)에서 `G_ID`라는 이름으로 사용
- 실질적으로 같은 값 체계

---

## 3. PCODE / P_ID (선수 코드)

### 3.1 형식
```
NNNNN (5자리 숫자)
```

### 3.2 실제 데이터 예시
| PCODE | 비고 |
|-------|------|
| `10005` | 초기 등록 선수 (1만번대) |
| `50030` | 현역 선수 (5만번대) |
| `50036` | 현역 선수 |
| `50054` | 현역 선수 |
| `70143` | 과거 선수 (7만번대) |
| `70408` | 과거 선수 |
| `90213` | 과거 선수 (9만번대) |
| `92301` | 과거 선수 |

### 3.3 번호 대역 추정
| 대역 | 추정 의미 |
|------|----------|
| 1xxxx | 코칭스태프/감독 (초기 등록) |
| 5xxxx | 현역 선수 (최근) |
| 6xxxx~9xxxx | 과거 선수 (1982~) |

### 3.4 특이값
- Hitter/Pitcher 테이블에서 `PCODE = 'T'` 또는 `PCODE = 'B'` → **팀 합계행** (T=원정 합계, B=홈 합계)
- person 테이블에서 `GYEAR` + `PCODE` 복합키 → 시즌별 선수 정보 이력 관리

---

## 4. 팀 코드 (T_ID / TEAM / HTEAM / VTEAM)

### 4.1 현재(2025) 팀 코드
| 코드 | 팀명 | 연고지 |
|------|------|--------|
| `HH` | 키움 히어로즈 | 서울(고척) |
| `HT` | KIA 타이거즈 | 광주 |
| `KT` | KT 위즈 | 수원 |
| `LG` | LG 트윈스 | 서울(잠실) |
| `LT` | 롯데 자이언츠 | 부산(사직) |
| `NC` | NC 다이노스 | 창원 |
| `OB` | 두산 베어스 | 서울(잠실) |
| `SK` | SSG 랜더스 | 인천(문학) |
| `SS` | 삼성 라이온즈 | 대구 |
| `WO` | 한화 이글스 | 대전 |

### 4.2 역사적 팀 코드 변천
| 코드 | 과거 팀명 → 현재 |
|------|-----------------|
| `OB` | OB 베어스 → 두산 베어스 |
| `SK` | SK 와이번스 → SSG 랜더스 |
| `HH` | 현대 유니콘스 → 키움 히어로즈 |
| `HT` | 해태 타이거즈 → KIA 타이거즈 |
| `HD` | 삼미/청보/태평양/현대 계보 |
| `WE` | 쌍방울/LG(서부) 계보 |
| `EA` | 청보/동부 계보 |

### 4.3 팀 코드 사용처
- `GAMEINFO.VTEAM` / `GAMEINFO.HTEAM`: 원정팀/홈팀 (2자)
- `ENTRY.TEAM`: `T`(홈) / `B`(원정) - **팀코드가 아닌 TB 구분**
- `GMKEY` 내 4~7번째 자리: 원정팀+홈팀 코드
- `TeamRank.TEAM`: 한글 팀명 (코드가 아님!)
- `BatTotal.SEC`: 팀명(한글) 또는 `'1'`(전체)
- `person.TEAM`: 팀명 또는 팀코드(불일치)

### 4.4 가을리그 특수 팀 코드
| 코드 | 팀명 |
|------|------|
| `CU` | 쿠바 |
| `MX` | LMB (멕시코) |

---

## 5. 구장 코드 (STADIUM / stadium_key / STAD)

### 5.1 구장 코드 매핑
| 코드 | 한글명 | 비고 |
|------|--------|------|
| `JS` | 잠실 | 서울 |
| `KC` | 고척 | 서울 → GAMEINFO에서는 `광주`로 표시되기도 |
| `GJ` | 무등/광주 | 광주 |
| `SW` | 수원 | 수원 |
| `DG` | 시민/대구 | 대구 |
| `DJ` | 대전 | 대전 |
| `IC` | 인천/문학 | 인천 |
| `SJ` | 사직 | 부산 |
| `CW` | 창원 | 창원 |
| `UL` | 울산 | 울산 |
| `PH` | 포항 | 포항 |
| `CJ` | 청주 | 청주 |
| `CH` | 춘천 | 춘천 |
| `JJ` | 전주 | 전주 |
| `JE` | 제주 | 제주 |
| `MS` | 마산 | 마산 |
| `DM` | 동대문 | 서울(폐장) |
| `KD` | 구덕 | 부산(폐장) |

### 5.2 STADIUM 테이블 구조
- `(gyear, stadium, stadium_key)`: 연도별 구장 매핑
- 487행: 1982년부터 시즌별 구장 목록
- GAMEINFO.STADIUM은 **한글 구장명**, STAD는 **2자 코드**

---

## 6. 시즌/리그/시리즈 식별자

### 6.1 GYEAR / SEASON_ID
- `GYEAR`: `smallint` 또는 `char(4)` - 시즌 연도 (1982~2025)
- `SEASON_ID`: `varchar` - 동일 의미, 신세대 네이밍
- 일부 테이블은 GMKEY에서 연도 추출 가능

### 6.2 LE_ID (리그 ID)
| 값 | 의미 (추정) |
|----|------------|
| `1` | 1군 정규시즌 |
| `2` | 가을리그/기타 |

### 6.3 SR_ID (시리즈 ID)
| 값 | 의미 (추정) |
|----|------------|
| `0` | 정규시즌 |
| `15` | 가을리그 |

---

## 7. 기타 식별자

### 7.1 SERNO (시퀀스 번호)
- `GAMECONTAPP.SERNO`: 경기 내 이벤트 순번
- `smallint` 타입, 경기별 1부터 시작
- 한 경기당 최대 약 200~300 이벤트

### 7.2 TURN / ONETURN
- `TURN`: 타순 + 교체순번 조합 (예: `10`=1번타자, `21`=2번타자 첫 교체)
- `ONETURN`: 경기 내 고유 타석 순번

### 7.3 복합 PK 구조
| 테이블 | PK 구성 |
|--------|---------|
| GAMECONTAPP | `GMKEY` + `GYEAR` + `SERNO` |
| ENTRY | `GMKEY` + `GYEAR` + `TURN` + `PCODE` + `POSI` |
| BatTotal | `GYEAR` + `PCODE` + `SEC` |
| PK_battotal_2 | `GYEAR` + `PCODE` + `SEC` (CLUSTERED) |

---

## 8. 식별자 체계 문제점 및 권고

### 8.1 문제점
1. **동일 개체에 2개 이름**: `GMKEY` = `G_ID`, `PCODE` = `P_ID` (세대별 다름)
2. **팀코드 혼란**: 코드(`HT`), 한글명(`키움`), 역사적 코드(`HD`)가 섞여있음
3. **PCODE 특수값**: 합계행에 `T`/`B` 사용 → 숫자 코드 체계와 혼재
4. **GMKEY의 팀코드가 과거 코드 고정**: `SK`(현 SSG), `OB`(현 두산) 등 변경 안됨
5. **구장 식별자 이중화**: `STADIUM`(한글), `STAD`(코드), `stadium_key`(코드)

### 8.2 표준화 권고
1. **경기 ID**: `G_ID` 통일, 형식 `YYYYMMDDVVHH#` 유지
2. **선수 ID**: `P_ID` 통일, 5자리 숫자 유지, 합계행은 별도 처리
3. **팀 ID**: `T_ID` 통일, 2자 코드, 역사적 코드 매핑 테이블 별도 관리
4. **구장 ID**: `S_ID` 통일, 2자 코드
5. **시즌 ID**: `SEASON_ID` 통일, 4자리 연도
